[Unit]
Description=Blog Application Health Monitor
Documentation=https://github.com/your-repo/blog
After=blog.service
Requires=blog.service

[Service]
Type=simple
User=root
Group=root
WorkingDirectory=/opt/blog/scripts

# 监控脚本
ExecStart=/opt/blog/scripts/monitor.sh

# 重启策略
Restart=always
RestartSec=30

# 环境变量
Environment=CHECK_INTERVAL=300
Environment=HEALTH_URL=http://localhost:3001/api/health
Environment=ALERT_EMAIL=admin@yourdomain.com
Environment=LOG_FILE=/opt/blog/logs/monitor.log

# 日志配置
StandardOutput=journal
StandardError=journal
SyslogIdentifier=blog-monitor

# 安全配置
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/opt/blog/logs

# 资源限制
MemoryLimit=128M
CPUQuota=10%

[Install]
WantedBy=multi-user.target